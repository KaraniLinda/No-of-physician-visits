---
title: "explaratory analysis - no of visits"
output: html_document
date: "2022-09-13"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Loading necessary libraries

library(tidyverse)
library(modelr)
library(broom)

```

```{r}
#Getting the data set

data <- read.csv("Health data set.csv")
```

# Data glimpse

```{r}
glimpse(data)
```

```{r}
summary(data)
```

# Data transformation

```{r}
data2 <- data %>% 
    mutate(actualage = age*10,
           familyincome = faminc*10000)
data2          

```

```{r}

#Frequency and range of the variables

library(sjPlot)
view_df(data2, show.string.values = TRUE, show.values = TRUE, show.frq = TRUE, show.labels = TRUE, show.prc = TRUE)
```

```{r}

# The average of phyicisian and non physician visits by race

data2 %>% 
    select(ofp,ofnp,opp,opnp,hlth) %>% 
    filter(hlth == "poor") %>% 
    summarise(across(1:4,mean))

data2 %>% 
    select(ofp,ofnp,opp,opnp,hlth) %>% 
    filter(hlth == "excellent") %>% 
    summarise(across(1:4,mean))

```


# Health across the different regions(Region Analysis)

```{r}
data2 %>% 
    ggplot(aes(x = faminc, y = ofp, colour = privins)) + geom_point() + facet_wrap(~region)

```

```{r}
data2 %>% 
    ggplot(aes(x = faminc, y = ofp, colour = medicaid)) + geom_point() + facet_wrap(~region)
```

```{r}
data2 %>% 
    ggplot(aes(x = numchron, y = ofp, fill = hlth)) + geom_boxplot() + facet_wrap(~region)

```

```{r}
data2 %>% 
    ggplot(aes(x = region,
               y = ofp)) +
    geom_boxplot()

```

## Observation

Most individuals in all the regions see a doctor between 0 and 25 times in a year regardless of the income earned. The ill individuals seem to be visiting the doctor more frequently compared to the healthy individuals in all the regions and they have an average of 2-4 chronic conditions.

In terms of insurance coverage, those with a low income seem to be insured by medicaid while the rest are insured by private insurance.


# Health across demographics.

## Age
```{r}
data2 %>% 
    ggplot(aes(x = actualage, y = ofp)) + geom_jitter()
```

```{r}
data2 %>% 
    ggplot(aes(x = actualage, y = numchron, colour = hlth)) + geom_jitter()
```

## Sex

```{r}
data2 %>% 
    ggplot(aes(x = ofp)) + geom_bar(aes(fill = sex))
```

```{r}
data2 %>% 
    ggplot(aes(x = faminc)) + geom_histogram(aes(fill = medicaid), bins = 30) + facet_wrap(~sex)


```



```{r}
data2 %>% 
    ggplot(aes(x = numchron, y = ofp, colour = hlth)) + geom_jitter() + facet_wrap(~sex)
```
## Race

```{r}

data2 %>% 
    ggplot(aes(x = numchron, y = emr, colour = hlth)) + geom_jitter() + facet_wrap(~black)

```

```{r}

data2 %>% 
    ggplot(aes(x = ofp, y = numchron, colour = privins)) + geom_point() + facet_wrap(~black)
           

```

```{r}
data2 %>% 
    ggplot(aes(x = ofp, y = numchron, colour = medicaid)) + geom_point() + facet_wrap(~black)
```
```{r}
data2 %>% 
    ggplot(aes(x = faminc)) + geom_histogram(aes(fill = medicaid), bins = 30) + facet_wrap(~black)

```



## Observations

Race does not seem to be influencing the number of hospital visits. In terms of insurance coverage, a majority of the African American population are not covered by private insurance. Those who have at least one chronic condition are covered by medicaid.
